
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Mail server configuration with Postfix and dovecot &#8212; Generic Config</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="etc-server/mysql/my.cnf" href="mysql/my.cnf.raw.html" />
    <link rel="prev" title="ejabberd configuration" href="jabber/ejabberd.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="mysql/my.cnf.raw.html" title="etc-server/mysql/my.cnf"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="jabber/ejabberd.html" title="ejabberd configuration"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Generic Config</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U"><code class="docutils literal notranslate"><span class="pre">/etc</span></code> for Server</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mail-server-configuration-with-postfix-and-dovecot">
<h1>Mail server configuration with Postfix and dovecot<a class="headerlink" href="#mail-server-configuration-with-postfix-and-dovecot" title="Permalink to this headline">¶</a></h1>
<p>This document describes 3 possible configurations:</p>
<ul class="simple">
<li><p>Simple server, where a local postfix server is used to send system messages
(cron, alerts…) to system admins.</p></li>
<li><p>Relay mail server, which is used to relay messages for a domain to real
mailbox (aliases).</p></li>
<li><p>Mailbox mail server, which is used to receive messages in user mailboxes which
can then be accessed through IMAP.</p></li>
</ul>
<p>Debian provides other configuration templates when installing <code class="docutils literal notranslate"><span class="pre">postfix</span></code>
package (or through <code class="docutils literal notranslate"><span class="pre">dpkg-reconfigure</span> <span class="pre">postfix</span></code>), like <em>Satellite system</em> and
<em>Internet with smarthost</em>.</p>
<div class="section" id="local-mail-server">
<h2>Local mail server<a class="headerlink" href="#local-mail-server" title="Permalink to this headline">¶</a></h2>
<p>Here are config files for a server named <code class="docutils literal notranslate"><span class="pre">examplehost</span></code> in domain <code class="docutils literal notranslate"><span class="pre">example.com</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">/etc/postfix/main.cf</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Some straightforward configuration</span>
<span class="nv">smtpd_banner</span> <span class="o">=</span> <span class="nv">$myhostname</span> ESMTP <span class="nv">$mail_name</span>
<span class="nv">biff</span> <span class="o">=</span> no
<span class="nv">readme_directory</span> <span class="o">=</span> no
<span class="nv">mailbox_size_limit</span> <span class="o">=</span> <span class="m">0</span>

<span class="c1"># Appending .domain is the MUA&#39;s job.</span>
<span class="nv">append_dot_mydomain</span> <span class="o">=</span> no

<span class="c1"># Uncomment the next line to generate &quot;delayed mail&quot; warnings</span>
<span class="c1">#delay_warning_time = 4h</span>

<span class="c1"># TLS parameters</span>
<span class="nv">smtpd_tls_cert_file</span><span class="o">=</span>/etc/ssl/certs/ssl-cert-snakeoil.pem
<span class="nv">smtpd_tls_key_file</span><span class="o">=</span>/etc/ssl/private/ssl-cert-snakeoil.key
<span class="nv">smtpd_use_tls</span><span class="o">=</span>yes
<span class="nv">smtpd_tls_session_cache_database</span> <span class="o">=</span> btree:<span class="si">${</span><span class="nv">data_directory</span><span class="si">}</span>/smtpd_scache
<span class="nv">smtp_tls_session_cache_database</span> <span class="o">=</span> btree:<span class="si">${</span><span class="nv">data_directory</span><span class="si">}</span>/smtp_scache
<span class="c1"># Exclude some protocols to mitigate SSL attacks</span>
<span class="nv">smtpd_tls_mandatory_protocols</span><span class="o">=</span>!SSLv2,!SSLv3
<span class="nv">smtp_tls_mandatory_protocols</span><span class="o">=</span>!SSLv2,!SSLv3
<span class="nv">smtpd_tls_protocols</span><span class="o">=</span>!SSLv2,!SSLv3
<span class="nv">smtp_tls_protocols</span><span class="o">=</span>!SSLv2,!SSLv3
<span class="nv">smtpd_tls_exclude_ciphers</span> <span class="o">=</span> aNULL, eNULL, EXPORT, DES, RC4, MD5, PSK, aECDH, EDH-DSS-DES-CBC3-SHA, EDH-RSA-DES-CDC3-SHA, KRB5-DE5, CBC3-SHA
<span class="c1"># The Diffie-Hellman parameters file can be generated with:</span>
<span class="c1"># openssl dhparam -out /etc/postfix/ssl/dh_1024.pem 1024</span>
<span class="nv">smtpd_tls_dh1024_param_file</span> <span class="o">=</span> <span class="si">${</span><span class="nv">config_directory</span><span class="si">}</span>/ssl/dh_1024.pem

<span class="c1"># Fully-qualified domain name of the machine</span>
<span class="nv">myhostname</span> <span class="o">=</span> examplehost.example.com

<span class="c1"># The domain associated with the mailing system</span>
<span class="c1"># By default is it $myhostname without the first prefix</span>
<span class="c1">#mydomain = example.com</span>

<span class="c1"># Mail addresses without a domain will use this one</span>
<span class="nv">myorigin</span> <span class="o">=</span> <span class="nv">$myhostname</span>

<span class="c1"># Networks for which the host should relay mail</span>
<span class="nv">mynetworks</span> <span class="o">=</span> <span class="m">127</span>.0.0.0/8 <span class="o">[</span>::ffff:127.0.0.0<span class="o">]</span>/104 <span class="o">[</span>::1<span class="o">]</span>/128
<span class="nv">mynetworks_style</span> <span class="o">=</span> host
<span class="nv">mailbox_size_limit</span> <span class="o">=</span> <span class="m">0</span>

<span class="c1"># Domains for which a local lookup needs to be performed</span>
<span class="c1"># By default, relay_domains = $mydestination so no need to write it down</span>
<span class="nv">mydestination</span> <span class="o">=</span> <span class="nv">$myhostname</span>, localhost.<span class="nv">$mydomain</span>, localhost

<span class="c1"># Only support local delivery</span>
<span class="nv">default_transport</span> <span class="o">=</span> error: Local delivery only!

<span class="c1"># Define alias databases</span>
<span class="nv">alias_maps</span> <span class="o">=</span> hash:/etc/aliases
<span class="nv">alias_database</span> <span class="o">=</span> hash:/etc/aliases

<span class="c1"># &quot;smarthost&quot; to send messages to</span>
<span class="nv">relayhost</span> <span class="o">=</span>

<span class="c1"># Character which is used to define a local address extension</span>
<span class="nv">recipient_delimiter</span> <span class="o">=</span> +

<span class="c1"># Only listen to the loopback interface</span>
<span class="nv">inet_interfaces</span> <span class="o">=</span> loopback-only
<span class="c1"># If this becomes misconfigured, reject all clients not in mynetworks</span>
<span class="nv">smtpd_client_restrictions</span> <span class="o">=</span> permit_mynetworks, reject

<span class="c1"># Use IPv4 and IPv6</span>
<span class="nv">inet_protocols</span> <span class="o">=</span> all
</pre></div>
</div>
<p>File <code class="docutils literal notranslate"><span class="pre">/etc/postfix/master.cf</span></code> does not need to be changed relatively to the default one:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Postfix master process configuration file.  For details on the format</span>
<span class="c1"># of the file, see the master(5) manual page (command: &quot;man 5 master&quot;).</span>
<span class="c1">#</span>
<span class="c1"># Do not forget to execute &quot;postfix reload&quot; after editing this file.</span>
<span class="c1">#</span>
<span class="c1"># ==========================================================================</span>
<span class="c1"># service type  private unpriv  chroot  wakeup  maxproc command + args</span>
<span class="c1">#               (yes)   (yes)   (yes)   (never) (100)</span>
<span class="c1"># ==========================================================================</span>
smtp      inet  n       -       -       -       -       smtpd
pickup    fifo  n       -       -       <span class="m">60</span>      <span class="m">1</span>       pickup
cleanup   unix  n       -       -       -       <span class="m">0</span>       cleanup
qmgr      fifo  n       -       n       <span class="m">300</span>     <span class="m">1</span>       qmgr
tlsmgr    unix  -       -       -       <span class="m">1000</span>?   <span class="m">1</span>       tlsmgr
rewrite   unix  -       -       -       -       -       trivial-rewrite
bounce    unix  -       -       -       -       <span class="m">0</span>       bounce
defer     unix  -       -       -       -       <span class="m">0</span>       bounce
trace     unix  -       -       -       -       <span class="m">0</span>       bounce
verify    unix  -       -       -       -       <span class="m">1</span>       verify
flush     unix  n       -       -       <span class="m">1000</span>?   <span class="m">0</span>       flush
proxymap  unix  -       -       n       -       -       proxymap
proxywrite unix -       -       n       -       <span class="m">1</span>       proxymap
smtp      unix  -       -       -       -       -       smtp
relay     unix  -       -       -       -       -       smtp
showq     unix  n       -       -       -       -       showq
error     unix  -       -       -       -       -       error
retry     unix  -       -       -       -       -       error
discard   unix  -       -       -       -       -       discard
<span class="nb">local</span>     unix  -       n       n       -       -       <span class="nb">local</span>
virtual   unix  -       n       n       -       -       virtual
lmtp      unix  -       -       -       -       -       lmtp
anvil     unix  -       -       -       -       <span class="m">1</span>       anvil
scache    unix  -       -       -       -       <span class="m">1</span>       scache
<span class="c1">#</span>
<span class="c1"># ====================================================================</span>
<span class="c1"># Interfaces to non-Postfix software. Be sure to examine the manual</span>
<span class="c1"># pages of the non-Postfix software to find out what options it wants.</span>
<span class="c1">#</span>
<span class="c1"># Many of the following services use the Postfix pipe(8) delivery</span>
<span class="c1"># agent.  See the pipe(8) man page for information about ${recipient}</span>
<span class="c1"># and other message envelope options.</span>
<span class="c1"># ====================================================================</span>
<span class="c1">#</span>
<span class="c1"># maildrop. See the Postfix MAILDROP_README file for details.</span>
<span class="c1"># Also specify in main.cf: maildrop_destination_recipient_limit=1</span>
<span class="c1">#</span>
maildrop  unix  -       n       n       -       -       pipe
  <span class="nv">flags</span><span class="o">=</span>DRhu <span class="nv">user</span><span class="o">=</span>vmail <span class="nv">argv</span><span class="o">=</span>/usr/bin/maildrop -d <span class="si">${</span><span class="nv">recipient</span><span class="si">}</span>
</pre></div>
</div>
<p>Finally <code class="docutils literal notranslate"><span class="pre">/etc/aliases</span></code> may contain some aliases so that most messages get
sent to user <code class="docutils literal notranslate"><span class="pre">localuser</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># See man 5 aliases for format</span>
root: localuser
mailer-daemon: postmaster
abuse: root
hostmaster: root
postmaster: root
nobody: root
webmaster: root
www: root
</pre></div>
</div>
<p>Run <code class="docutils literal notranslate"><span class="pre">newaliases</span></code> every time this file is updated.</p>
<p>To validate the configuration, run <code class="docutils literal notranslate"><span class="pre">postfix</span> <span class="pre">check</span></code>.</p>
</div>
<div class="section" id="relay-mode-configuration">
<h2>Relay-mode configuration<a class="headerlink" href="#relay-mode-configuration" title="Permalink to this headline">¶</a></h2>
<p>This section describes a Postfix configuration for a relay domain, which
transmits e-mails to addresses behind aliases.  To set-up such a server,
it is possible to use the same configuration as the local mail server, with
a modification to <code class="docutils literal notranslate"><span class="pre">/etc/postfix/main.cf</span></code> to allow connections from all
network interfaces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inet_interfaces</span> <span class="o">=</span> <span class="nb">all</span>
</pre></div>
</div>
<p>The aliases can then be configured in <code class="docutils literal notranslate"><span class="pre">/etc/aliases</span></code>, or more generally to
the file configured in <code class="docutils literal notranslate"><span class="pre">alias_maps</span></code> and <code class="docutils literal notranslate"><span class="pre">alias_database</span></code> variables</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> postconf <span class="p">|</span>grep <span class="s1">&#39;^alias_&#39;</span>
<span class="go">alias_database = hash:/etc/aliases</span>
<span class="go">alias_maps = hash:/etc/aliases</span>
</pre></div>
</div>
<p>To send local emails as <code class="docutils literal notranslate"><span class="pre">root+hostname&#64;example.com</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">root&#64;hostname.example.com</span></code>, a canonical mapping can be added:</p>
<ul>
<li><p>in <code class="docutils literal notranslate"><span class="pre">/etc/postfix/main.cf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">canonical_classes</span> <span class="o">=</span> <span class="n">envelope_sender</span><span class="p">,</span> <span class="n">header_sender</span><span class="p">,</span> <span class="n">header_recipient</span>
<span class="n">canonical_maps</span> <span class="o">=</span> <span class="n">regexp</span><span class="p">:</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">postfix</span><span class="o">/</span><span class="n">canonical</span><span class="o">.</span><span class="n">regexp</span>
</pre></div>
</div>
</li>
<li><p>in <code class="docutils literal notranslate"><span class="pre">/etc/postfix/canonical.regexp</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>/^([^@]*)@([a-zA-Z0-9]*)\.(example\.com)/ ${1}+${2}@${3}
</pre></div>
</div>
</li>
<li><p>and finally compile the mapping with <code class="docutils literal notranslate"><span class="pre">postmap</span> <span class="pre">/etc/postfix/canonical.regexp</span></code>.</p></li>
</ul>
<p>To enable SMTPS as STARTTLS over SMTP (TCP port 587), add the following lines to
<code class="docutils literal notranslate"><span class="pre">/etc/postfix/master.cf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">submission</span> <span class="n">inet</span> <span class="n">n</span>       <span class="o">-</span>       <span class="o">-</span>       <span class="o">-</span>       <span class="o">-</span>       <span class="n">smtpd</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">syslog_name</span><span class="o">=</span><span class="n">postfix</span><span class="o">/</span><span class="n">submission</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">smtpd_tls_security_level</span><span class="o">=</span><span class="n">encrypt</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">smtpd_sasl_auth_enable</span><span class="o">=</span><span class="n">yes</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">smtpd_client_restrictions</span><span class="o">=</span><span class="n">permit_sasl_authenticated</span><span class="p">,</span><span class="n">reject</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">milter_macro_daemon_name</span><span class="o">=</span><span class="n">ORIGINATING</span>
</pre></div>
</div>
<p>In this configuration <code class="docutils literal notranslate"><span class="pre">smtpd_client_restrictions</span></code> disables
<code class="docutils literal notranslate"><span class="pre">reject_unauth_destination</span></code> so that relaying over SMTPS works.</p>
<p>On the firewall, TCP ports 25 and 587 need to be opened for SMTP and SMTPS, and
143 and 993 for IMAP (with STARTTLS) and IMAPS.  With iptables, the commands
are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">-</span><span class="n">m</span> <span class="n">multiport</span> <span class="o">--</span><span class="n">dports</span> <span class="mi">25</span><span class="p">,</span><span class="mi">143</span><span class="p">,</span><span class="mi">587</span><span class="p">,</span><span class="mi">993</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="n">iptables</span> <span class="o">-</span><span class="n">A</span> <span class="n">OUTPUT</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">-</span><span class="n">m</span> <span class="n">multiport</span> <span class="o">--</span><span class="n">sports</span> <span class="mi">25</span><span class="p">,</span><span class="mi">143</span><span class="p">,</span><span class="mi">587</span><span class="p">,</span><span class="mi">993</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="n">ip6tables</span> <span class="o">-</span><span class="n">A</span> <span class="n">INPUT</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">-</span><span class="n">m</span> <span class="n">multiport</span> <span class="o">--</span><span class="n">dports</span> <span class="mi">25</span><span class="p">,</span><span class="mi">143</span><span class="p">,</span><span class="mi">587</span><span class="p">,</span><span class="mi">993</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
<span class="n">ip6tables</span> <span class="o">-</span><span class="n">A</span> <span class="n">OUTPUT</span> <span class="o">-</span><span class="n">p</span> <span class="n">tcp</span> <span class="o">-</span><span class="n">m</span> <span class="n">multiport</span> <span class="o">--</span><span class="n">sports</span> <span class="mi">25</span><span class="p">,</span><span class="mi">143</span><span class="p">,</span><span class="mi">587</span><span class="p">,</span><span class="mi">993</span> <span class="o">-</span><span class="n">j</span> <span class="n">ACCEPT</span>
</pre></div>
</div>
</div>
<div class="section" id="mailbox-mail-server">
<h2>Mailbox mail server<a class="headerlink" href="#mailbox-mail-server" title="Permalink to this headline">¶</a></h2>
<p>To setup a mail server with mailboxes, the first step is to setup the relay-mode
configuration, and then add local accounts and configure dovecot to serve the
mailbox of these accounts over IMAP.</p>
<p>To install dovecot on Debian, two packages need to be installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aptitude</span> <span class="n">install</span> <span class="n">dovecot</span><span class="o">-</span><span class="n">core</span> <span class="n">dovecot</span><span class="o">-</span><span class="n">imapd</span>
</pre></div>
</div>
<p>Then the default configuration is available through <code class="docutils literal notranslate"><span class="pre">doveconf</span> <span class="pre">-n</span></code> command.
This can be use as a source of inspiration, but customizations are simpler when
everything lies in a single file.  By default, <code class="docutils literal notranslate"><span class="pre">dovecot.conf</span></code> includes every
file matched by glob pattern <code class="docutils literal notranslate"><span class="pre">/etc/dovecot/conf.d/*.conf</span></code> and tries to include
<code class="docutils literal notranslate"><span class="pre">/etc/dovecot/local.conf</span></code> with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!include_try local.conf
</pre></div>
</div>
<p>To fully control the configuration, it is possible to comment
<code class="docutils literal notranslate"><span class="pre">!include</span> <span class="pre">conf.d/*.conf</span></code> and write in <code class="docutils literal notranslate"><span class="pre">/etc/dovecot/local.conf</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Enable and require TLS communication</span>
<span class="nv">ssl</span> <span class="o">=</span> required
<span class="nv">ssl_cert</span> <span class="o">=</span> &lt;/etc/ssl/dovecot/dovecot.crt
<span class="c1"># Do not forget to make /etc/ssl/dovecot/dovecot.key only readable by root</span>
<span class="nv">ssl_key</span> <span class="o">=</span> &lt;/etc/ssl/dovecot/dovecot.key

<span class="c1"># Disable plaintext authentication</span>
<span class="nv">disable_plaintext_auth</span> <span class="o">=</span> yes

<span class="c1"># Authenticate using PAM</span>
<span class="nv">auth_mechanisms</span> <span class="o">=</span> plain
userdb <span class="o">{</span>
  <span class="nv">driver</span> <span class="o">=</span> passwd
<span class="o">}</span>
passdb <span class="o">{</span>
  <span class="nv">driver</span> <span class="o">=</span> pam
<span class="o">}</span>

<span class="c1"># Use Maildir</span>
<span class="nv">mail_location</span> <span class="o">=</span> maildir:~/Maildir
namespace inbox <span class="o">{</span>
  <span class="nv">inbox</span> <span class="o">=</span> yes
  <span class="c1">#location =</span>
  <span class="c1">#prefix =</span>
  <span class="nv">separator</span> <span class="o">=</span> /
<span class="o">}</span>

<span class="c1"># Create a socket to use dovecot authentication in postfix</span>
service auth <span class="o">{</span>
  unix_listener /var/spool/postfix/private/auth <span class="o">{</span>
    <span class="nv">mode</span> <span class="o">=</span> <span class="m">0660</span>
    <span class="nv">user</span> <span class="o">=</span> postfix
    <span class="nv">group</span> <span class="o">=</span> postfix
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Also configure Postfix to use qmail-style delivery, with this in
<code class="docutils literal notranslate"><span class="pre">/etc/postfix/main.cf</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Deliver mails in ~/Maildir/ (the trailing / is required)</span>
<span class="nv">home_mailbox</span> <span class="o">=</span> Maildir/
</pre></div>
</div>
<p>The dovecot authentication can then be activated in Postfix by updating the
entry for SMTPS service in <code class="docutils literal notranslate"><span class="pre">/etc/postfix/master.cf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">submission</span> <span class="n">inet</span> <span class="n">n</span>       <span class="o">-</span>       <span class="o">-</span>       <span class="o">-</span>       <span class="o">-</span>       <span class="n">smtpd</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">syslog_name</span><span class="o">=</span><span class="n">postfix</span><span class="o">/</span><span class="n">submission</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">smtpd_tls_wrappermode</span><span class="o">=</span><span class="n">no</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">smtpd_tls_security_level</span><span class="o">=</span><span class="n">encrypt</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">smtpd_sasl_auth_enable</span><span class="o">=</span><span class="n">yes</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">smtpd_recipient_restrictions</span><span class="o">=</span><span class="n">permit_mynetworks</span><span class="p">,</span><span class="n">permit_sasl_authenticated</span><span class="p">,</span><span class="n">reject</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">milter_macro_daemon_name</span><span class="o">=</span><span class="n">ORIGINATING</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">smtpd_sasl_type</span><span class="o">=</span><span class="n">dovecot</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">smtpd_sasl_path</span><span class="o">=</span><span class="n">private</span><span class="o">/</span><span class="n">auth</span>
</pre></div>
</div>
<p>Moreover in Postfix configuration, local delivery is configured with
<code class="docutils literal notranslate"><span class="pre">local_recipient_maps</span></code> which has a default value which is correct:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># postconf local_recipient_maps</span>
<span class="nv">local_recipient_maps</span> <span class="o">=</span> proxy:unix:passwd.byname <span class="nv">$alias_maps</span>
</pre></div>
</div>
</div>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>Here are some useful links to configure a mail server:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://wiki.archlinux.org/index.php/Postfix">https://wiki.archlinux.org/index.php/Postfix</a></p></li>
<li><p><a class="reference external" href="https://wiki.archlinux.org/index.php/Virtual_user_mail_system">https://wiki.archlinux.org/index.php/Virtual_user_mail_system</a></p></li>
<li><p><a class="reference external" href="http://wiki2.dovecot.org/QuickConfiguration">http://wiki2.dovecot.org/QuickConfiguration</a></p></li>
<li><p><a class="reference external" href="http://wiki2.dovecot.org/MailboxFormat">http://wiki2.dovecot.org/MailboxFormat</a> A list of mailbox formats</p></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Mail server configuration with Postfix and dovecot</a><ul>
<li><a class="reference internal" href="#local-mail-server">Local mail server</a></li>
<li><a class="reference internal" href="#relay-mode-configuration">Relay-mode configuration</a></li>
<li><a class="reference internal" href="#mailbox-mail-server">Mailbox mail server</a></li>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="jabber/ejabberd.html"
                        title="previous chapter">ejabberd configuration</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mysql/my.cnf.raw.html"
                        title="next chapter"><code class="docutils literal notranslate"><span class="pre">etc-server/mysql/my.cnf</span></code></a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/etc-server/mail.rst.txt"
           rel="nofollow">Show Source</a></li>
    <li><a href="https://github.com/fishilico/generic-config/blob/master/etc-server/mail.rst"
           rel="nofollow">Show Source on GitHub
           <img src="../_static/GitHub-Mark-32px.png" style="width: 1.5em; border: none;" alt="" />
           </a></li>
  </ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="mysql/my.cnf.raw.html" title="etc-server/mysql/my.cnf"
             >next</a> |</li>
        <li class="right" >
          <a href="jabber/ejabberd.html" title="ejabberd configuration"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Generic Config</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" ><code class="docutils literal notranslate"><span class="pre">/etc</span></code> for Server</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013-2019, Nicolas Iooss.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>