
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>PHP Configuration Customization &#8212; Generic Config</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="SSL configuration on a web server" href="ssl.html" />
    <link rel="prev" title="etc-server/web/nginx.conf" href="nginx.conf.raw.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ssl.html" title="SSL configuration on a web server"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nginx.conf.raw.html" title="etc-server/web/nginx.conf"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Generic Config</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U"><code class="docutils literal notranslate"><span class="pre">/etc</span></code> for Server</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="php-configuration-customization">
<h1>PHP Configuration Customization<a class="headerlink" href="#php-configuration-customization" title="Permalink to this headline">¶</a></h1>
<p>Here are some tips &amp; tricks to configure a php.ini file.</p>
<div class="section" id="php-ini-configuration">
<h2><code class="docutils literal notranslate"><span class="pre">php.ini</span></code> configuration<a class="headerlink" href="#php-ini-configuration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="common-important-configuration-options">
<h3>Common important configuration options<a class="headerlink" href="#common-important-configuration-options" title="Permalink to this headline">¶</a></h3>
<p>Here are some options I use in both development and production environments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">;</span> <span class="n">Decides</span> <span class="n">whether</span> <span class="n">PHP</span> <span class="n">may</span> <span class="n">expose</span> <span class="n">the</span> <span class="n">fact</span> <span class="n">that</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">installed</span> <span class="n">on</span> <span class="n">the</span> <span class="n">server</span>
<span class="p">;</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">by</span> <span class="n">adding</span> <span class="n">its</span> <span class="n">signature</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Web</span> <span class="n">server</span> <span class="n">header</span><span class="p">)</span><span class="o">.</span>  <span class="n">It</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">security</span>
<span class="p">;</span> <span class="n">threat</span> <span class="ow">in</span> <span class="nb">any</span> <span class="n">way</span><span class="p">,</span> <span class="n">but</span> <span class="n">it</span> <span class="n">makes</span> <span class="n">it</span> <span class="n">possible</span> <span class="n">to</span> <span class="n">determine</span> <span class="n">whether</span> <span class="n">you</span> <span class="n">use</span> <span class="n">PHP</span>
<span class="p">;</span> <span class="n">on</span> <span class="n">your</span> <span class="n">server</span> <span class="ow">or</span> <span class="ow">not</span><span class="o">.</span>
<span class="p">;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">php</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">expose</span><span class="o">-</span><span class="n">php</span>
<span class="p">;;</span><span class="n">expose_php</span> <span class="o">=</span> <span class="n">On</span>
<span class="n">expose_php</span> <span class="o">=</span> <span class="n">Off</span>

<span class="n">include_path</span> <span class="o">=</span> <span class="s2">&quot;.:/usr/share/pear:/usr/share/php&quot;</span>

<span class="p">;</span> <span class="n">Whether</span> <span class="n">to</span> <span class="n">allow</span> <span class="n">the</span> <span class="n">treatment</span> <span class="n">of</span> <span class="n">URLs</span> <span class="p">(</span><span class="n">like</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span> <span class="ow">or</span> <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="p">)</span> <span class="k">as</span> <span class="n">files</span><span class="o">.</span>
<span class="p">;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">php</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">allow</span><span class="o">-</span><span class="n">url</span><span class="o">-</span><span class="n">fopen</span>
<span class="p">;;</span><span class="n">allow_url_fopen</span> <span class="o">=</span> <span class="n">On</span>
<span class="n">allow_url_fopen</span> <span class="o">=</span> <span class="n">Off</span>

<span class="p">;</span> <span class="n">Whether</span> <span class="n">to</span> <span class="n">allow</span> <span class="n">include</span><span class="o">/</span><span class="n">require</span> <span class="n">to</span> <span class="nb">open</span> <span class="n">URLs</span> <span class="p">(</span><span class="n">like</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span> <span class="ow">or</span> <span class="n">ftp</span><span class="p">:</span><span class="o">//</span><span class="p">)</span> <span class="k">as</span> <span class="n">files</span><span class="o">.</span>
<span class="p">;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">php</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">allow</span><span class="o">-</span><span class="n">url</span><span class="o">-</span><span class="n">include</span>
<span class="n">allow_url_include</span> <span class="o">=</span> <span class="n">Off</span>

<span class="p">[</span><span class="n">Date</span><span class="p">]</span>
<span class="p">;</span> <span class="n">Defines</span> <span class="n">the</span> <span class="n">default</span> <span class="n">timezone</span> <span class="n">used</span> <span class="n">by</span> <span class="n">the</span> <span class="n">date</span> <span class="n">functions</span>
<span class="p">;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">php</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">date</span><span class="o">.</span><span class="n">timezone</span>
<span class="p">;</span><span class="n">date</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span>
<span class="n">date</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="s2">&quot;Europe/Paris&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="development-vs-production-options">
<h3>Development vs. Production options<a class="headerlink" href="#development-vs-production-options" title="Permalink to this headline">¶</a></h3>
<p>Here are the options which are likely to be different in dev and in prod:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>; open_basedir, if set, limits all file operations to the defined directory
; and below.  This directive makes most sense if used in a per-directory
; or per-virtualhost web server configuration file. This directive is
; *NOT* affected by whether Safe Mode is turned On or Off.
; http://php.net/open-basedir
; Production value:
open_basedir = /srv/http/:/tmp/:/usr/share/pear/:/usr/share/webapps/
; Development value:
open_basedir = /srv/http/:/tmp/:/usr/share/pear/:/usr/share/php/:/dev/urandom:/media/:/home:/usr/bin/phpunit

; This directive informs PHP of which errors, warnings and notices you would like
; it to take action for. The recommended way of setting values for this
; directive is through the use of the error level constants and bitwise
; operators. The error level constants are below here for convenience as well as
; some common settings and their meanings.
; By default, PHP is set to take action on all errors, notices and warnings EXCEPT
; those related to E_NOTICE and E_STRICT, which together cover best practices and
; recommended coding standards in PHP. For performance reasons, this is the
; recommend error reporting setting. Your production server shouldn&#39;t be wasting
; resources complaining about best practices and coding standards. That&#39;s what
; development servers and development settings are for.
; Note: The php.ini-development file has this setting as E_ALL. This
; means it pretty much reports everything which is exactly what you want during
; development and early testing.
;
; Error Level Constants:
; E_ALL             - All errors and warnings (includes E_STRICT as of PHP 5.4.0)
; E_ERROR           - fatal run-time errors
; E_RECOVERABLE_ERROR  - almost fatal run-time errors
; E_WARNING         - run-time warnings (non-fatal errors)
; E_PARSE           - compile-time parse errors
; E_NOTICE          - run-time notices (these are warnings which often result
;                     from a bug in your code, but it&#39;s possible that it was
;                     intentional (e.g., using an uninitialized variable and
;                     relying on the fact it&#39;s automatically initialized to an
;                     empty string)
; E_STRICT          - run-time notices, enable to have PHP suggest changes
;                     to your code which will ensure the best interoperability
;                     and forward compatibility of your code
; E_CORE_ERROR      - fatal errors that occur during PHP&#39;s initial startup
; E_CORE_WARNING    - warnings (non-fatal errors) that occur during PHP&#39;s
;                     initial startup
; E_COMPILE_ERROR   - fatal compile-time errors
; E_COMPILE_WARNING - compile-time warnings (non-fatal errors)
; E_USER_ERROR      - user-generated error message
; E_USER_WARNING    - user-generated warning message
; E_USER_NOTICE     - user-generated notice message
; E_DEPRECATED      - warn about code that will not work in future versions
;                     of PHP
; E_USER_DEPRECATED - user-generated deprecation warnings
;
; Common Values:
;   E_ALL (Show all errors, warnings and notices including coding standards.)
;   E_ALL &amp; ~E_NOTICE  (Show all errors, except for notices)
;   E_ALL &amp; ~E_NOTICE &amp; ~E_STRICT  (Show all errors, except for notices and coding standards warnings.)
;   E_COMPILE_ERROR|E_RECOVERABLE_ERROR|E_ERROR|E_CORE_ERROR  (Show only errors)
; Default Value: E_ALL &amp; ~E_NOTICE &amp; ~E_STRICT &amp; ~E_DEPRECATED
; Development Value: E_ALL
; Production Value: E_ALL &amp; ~E_DEPRECATED &amp; ~E_STRICT
; http://php.net/error-reporting
;;error_reporting = E_ALL &amp; ~E_DEPRECATED &amp; ~E_STRICT
error_reporting = E_ALL | E_STRICT

; This directive controls whether or not and where PHP will output errors,
; notices and warnings too. Error output is very useful during development, but
; it could be very dangerous in production environments. Depending on the code
; which is triggering the error, sensitive information could potentially leak
; out of your application such as database usernames and passwords or worse.
; It&#39;s recommended that errors be logged on production servers rather than
; having the errors sent to STDOUT.
; Possible Values:
;   Off = Do not display any errors
;   stderr = Display errors to STDERR (affects only CGI/CLI binaries!)
;   On or stdout = Display errors to STDOUT
; Default Value: On
; Development Value: On
; Production Value: Off
; http://php.net/display-errors
;;display_errors = Off
display_errors = On

; The display of errors which occur during PHP&#39;s startup sequence are handled
; separately from display_errors. PHP&#39;s default behavior is to suppress those
; errors from clients. Turning the display of startup errors on can be useful in
; debugging configuration problems. But, it&#39;s strongly recommended that you
; leave this setting off on production servers.
; Default Value: Off
; Development Value: On
; Production Value: Off
; http://php.net/display-startup-errors
;;display_startup_errors = Off
display_startup_errors = On
</pre></div>
</div>
</div>
<div class="section" id="php-size-limits">
<h3>PHP size limits<a class="headerlink" href="#php-size-limits" title="Permalink to this headline">¶</a></h3>
<p>In some configurations it may be needed to raise the limits on memory resource
usage.  Here are some relevant options in <code class="docutils literal notranslate"><span class="pre">php.ini</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">;</span> <span class="n">Maximum</span> <span class="n">amount</span> <span class="n">of</span> <span class="n">memory</span> <span class="n">a</span> <span class="n">script</span> <span class="n">may</span> <span class="n">consume</span> <span class="p">(</span><span class="mi">128</span><span class="n">MB</span><span class="p">)</span>
<span class="p">;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">php</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">memory</span><span class="o">-</span><span class="n">limit</span>
<span class="p">;</span><span class="n">memory_limit</span> <span class="o">=</span> <span class="mi">128</span><span class="n">M</span>
<span class="n">memory_limit</span> <span class="o">=</span> <span class="mi">1</span><span class="n">G</span>

<span class="p">;</span> <span class="n">Maximum</span> <span class="n">size</span> <span class="n">of</span> <span class="n">POST</span> <span class="n">data</span> <span class="n">that</span> <span class="n">PHP</span> <span class="n">will</span> <span class="n">accept</span><span class="o">.</span>
<span class="p">;</span> <span class="n">Its</span> <span class="n">value</span> <span class="n">may</span> <span class="n">be</span> <span class="mi">0</span> <span class="n">to</span> <span class="n">disable</span> <span class="n">the</span> <span class="n">limit</span><span class="o">.</span> <span class="n">It</span> <span class="ow">is</span> <span class="n">ignored</span> <span class="k">if</span> <span class="n">POST</span> <span class="n">data</span> <span class="n">reading</span>
<span class="p">;</span> <span class="ow">is</span> <span class="n">disabled</span> <span class="n">through</span> <span class="n">enable_post_data_reading</span><span class="o">.</span>
<span class="p">;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">php</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">post</span><span class="o">-</span><span class="nb">max</span><span class="o">-</span><span class="n">size</span>
<span class="p">;</span><span class="n">post_max_size</span> <span class="o">=</span> <span class="mi">8</span><span class="n">M</span>
<span class="n">post_max_size</span> <span class="o">=</span> <span class="mi">2</span><span class="n">G</span>

<span class="p">;</span> <span class="n">Maximum</span> <span class="n">allowed</span> <span class="n">size</span> <span class="k">for</span> <span class="n">uploaded</span> <span class="n">files</span><span class="o">.</span>
<span class="p">;</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">php</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">upload</span><span class="o">-</span><span class="nb">max</span><span class="o">-</span><span class="n">filesize</span>
<span class="p">;</span><span class="n">upload_max_filesize</span> <span class="o">=</span> <span class="mi">2</span><span class="n">M</span>
<span class="n">upload_max_filesize</span> <span class="o">=</span> <span class="mi">2</span><span class="n">G</span>
</pre></div>
</div>
</div>
<div class="section" id="debian-default-configuration-file">
<h3>Debian default configuration file<a class="headerlink" href="#debian-default-configuration-file" title="Permalink to this headline">¶</a></h3>
<p>With PHP 5, the default configuration file that Debian ships is installed in
<code class="docutils literal notranslate"><span class="pre">/usr/share/php5/php.ini-production</span></code>. Each time this file gets updated it is
possible to re-sync <code class="docutils literal notranslate"><span class="pre">php.ini</span></code> with a command like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vimdiff</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">php5</span><span class="o">/</span><span class="n">fpm</span><span class="o">/</span><span class="n">php</span><span class="o">.</span><span class="n">ini</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">php5</span><span class="o">/</span><span class="n">php</span><span class="o">.</span><span class="n">ini</span><span class="o">-</span><span class="n">production</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="extensions-list">
<h2>Extensions list<a class="headerlink" href="#extensions-list" title="Permalink to this headline">¶</a></h2>
<p>Here are some extensions to enable for most common-purpose websites:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">curl</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">gd</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">gettext</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">iconv</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">mcrypt</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">mysqli</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">mysql</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">pdo_mysql</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">pdo_pgsql</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">pdo_sqlite</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">pgsql</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">sqlite3</span></code></li>
</ul>
</div>
<div class="section" id="apache-configuration">
<h2>Apache configuration<a class="headerlink" href="#apache-configuration" title="Permalink to this headline">¶</a></h2>
<p>Apache has a module to run PHP. On Debian its installation is simple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">libapache2</span><span class="o">-</span><span class="n">mod</span><span class="o">-</span><span class="n">php5</span>
<span class="n">a2enmod</span> <span class="n">php5</span>
</pre></div>
</div>
<p>This will automatically load <code class="docutils literal notranslate"><span class="pre">/usr/lib/apache2/modules/libphp5.so</span></code> and
configure Apache so that <code class="docutils literal notranslate"><span class="pre">.php</span></code> files (and other extensions) are handled to
PHP module for execution.</p>
<p>To disable the PHP engine for some folders, use <code class="docutils literal notranslate"><span class="pre">php_admin_value</span></code> directive
in <code class="docutils literal notranslate"><span class="pre">&lt;Directory&gt;</span></code> sections. For example this disables PHP in home directories:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">IfModule</span> <span class="n">mod_userdir</span><span class="o">.</span><span class="n">c</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">Directory</span> <span class="o">/</span><span class="n">home</span><span class="o">/*/</span><span class="n">public_html</span><span class="o">&gt;</span>
        <span class="n">php_admin_value</span> <span class="n">engine</span> <span class="n">Off</span>
    <span class="o">&lt;/</span><span class="n">Directory</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">IfModule</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="section" id="rewrite-module">
<h3>Rewrite module<a class="headerlink" href="#rewrite-module" title="Permalink to this headline">¶</a></h3>
<p>To have nicer URLs, many websites setup a hook to call <code class="docutils literal notranslate"><span class="pre">index.php</span></code> with a part of the path in its parameter. In Apache, this behavior is achieved thanks to the rewrite module. To enable this module on Debian, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a2enmod</span> <span class="n">rewrite</span>
</pre></div>
</div>
<p>Then ensure that you have this directive in your virtual host configuration, to
allow <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AllowOverride</span> <span class="n">All</span>
</pre></div>
</div>
<p>Finally, put a <code class="docutils literal notranslate"><span class="pre">.htaccess</span></code> file where you want to split the path and write
lines such as these ones in it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;IfModule mod_rewrite.c&gt;
    RewriteEngine on
    RewriteBase /path/to/current/directory
    # Only rewrite non-existing files and directories
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?path=$1 [L,QSA]
&lt;/IfModule&gt;
</pre></div>
</div>
<p>Module doc: <a class="reference external" href="https://httpd.apache.org/docs/current/mod/mod_rewrite.html">https://httpd.apache.org/docs/current/mod/mod_rewrite.html</a></p>
</div>
</div>
<div class="section" id="nginx-configuration">
<h2>Nginx configuration<a class="headerlink" href="#nginx-configuration" title="Permalink to this headline">¶</a></h2>
<p>Nginx doesn’t use PHP as a module so you have to run another daemon which
provides a CGI-like gateway. For example, you may use <code class="docutils literal notranslate"><span class="pre">php5-fpm</span></code> daemon,
which installation is trivial on Debian:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">php5</span><span class="o">-</span><span class="n">fpm</span>
<span class="n">update</span><span class="o">-</span><span class="n">rc</span><span class="o">.</span><span class="n">d</span> <span class="n">php5</span><span class="o">-</span><span class="n">fpm</span> <span class="n">defaults</span>
</pre></div>
</div>
<p>This daemon creates an Unix socket in <code class="docutils literal notranslate"><span class="pre">/var/run/php5-fpm.sock</span></code>.
Use something like this to connect nginx to php5-fpm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>server {
    listen 80;
    listen [::]:80;

    root /var/www/localhost/htdocs;
    location ~ ^(.+?\.php)(/.*)?$ {
        try_files $1 =404;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$1;
        fastcgi_param PATH_INFO $2;
        fastcgi_pass unix:/var/run/php5-fpm.sock;
    }
}
</pre></div>
</div>
<p>Indeed all the mandatory parameters for fastcgi interface are already defined
in <code class="docutils literal notranslate"><span class="pre">/etc/nginx/fastcgi_params</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>fastcgi_param   QUERY_STRING            $query_string;
fastcgi_param   REQUEST_METHOD          $request_method;
fastcgi_param   CONTENT_TYPE            $content_type;
fastcgi_param   CONTENT_LENGTH          $content_length;

fastcgi_param   SCRIPT_FILENAME         $request_filename;
fastcgi_param   SCRIPT_NAME             $fastcgi_script_name;
fastcgi_param   REQUEST_URI             $request_uri;
fastcgi_param   DOCUMENT_URI            $document_uri;
fastcgi_param   DOCUMENT_ROOT           $document_root;
fastcgi_param   SERVER_PROTOCOL         $server_protocol;

fastcgi_param   GATEWAY_INTERFACE       CGI/1.1;
fastcgi_param   SERVER_SOFTWARE         nginx/$nginx_version;

fastcgi_param   REMOTE_ADDR             $remote_addr;
fastcgi_param   REMOTE_PORT             $remote_port;
fastcgi_param   SERVER_ADDR             $server_addr;
fastcgi_param   SERVER_PORT             $server_port;
fastcgi_param   SERVER_NAME             $server_name;

fastcgi_param   HTTPS                   $https;

# PHP only, required if PHP was built with --enable-force-cgi-redirect
fastcgi_param   REDIRECT_STATUS         200;
</pre></div>
</div>
<p>PHP can also be enabled only in a specific subdirectory of a location:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>server {
    [...]
    # The trailing slash makes nginx redirect &quot;/subdir&quot; to &quot;/subdir/&quot;
    location /subdir/ {
        alias /var/www/localhost/htdocs/specialPHPdir/;
        location ~ ^(/subdir)(.+?\.php)(/.*)?$ {
            try_files $2 =404;
            include fastcgi_params;
            fastcgi_param SCRIPT_FILENAME $document_root$2;
            fastcgi_param SCRIPT_NAME $1$2;
            fastcgi_param PATH_INFO $3;
            fastcgi_param DOCUMENT_URI $1$2;
            fastcgi_pass unix:/var/run/php5-fpm.sock;
        }
    }
}
</pre></div>
</div>
<div class="section" id="rewrite-directive">
<h3>Rewrite directive<a class="headerlink" href="#rewrite-directive" title="Permalink to this headline">¶</a></h3>
<p>Nginx provides an HTTP rewrite module to change URIs dynamically. This directive
sets up pseudo subdirectories in <code class="docutils literal notranslate"><span class="pre">/path</span></code> URI which are handled by <code class="docutils literal notranslate"><span class="pre">page.php</span></code>
script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>rewrite ^/path(/.*)$ /page.php$1 last;
</pre></div>
</div>
<p>Module doc: <a class="reference external" href="http://nginx.org/en/docs/http/ngx_http_rewrite_module.html">http://nginx.org/en/docs/http/ngx_http_rewrite_module.html</a></p>
</div>
</div>
<div class="section" id="lighttpd-configuration">
<h2>Lighttpd configuration<a class="headerlink" href="#lighttpd-configuration" title="Permalink to this headline">¶</a></h2>
<p>Like Nginx, Lighttpd can use PHP through a CGI or FastCGI application like
PHP-FPM.  Here are some documentation links:</p>
<ul class="simple">
<li><a class="reference external" href="http://redmine.lighttpd.net/projects/lighttpd/wiki/Docs_ConfigurationOptions#mod_fastcgi-fastcgi">http://redmine.lighttpd.net/projects/lighttpd/wiki/Docs_ConfigurationOptions#mod_fastcgi-fastcgi</a></li>
<li><a class="reference external" href="https://wiki.archlinux.org/index.php/lighttpd#Using_php-fpm">https://wiki.archlinux.org/index.php/lighttpd#Using_php-fpm</a></li>
</ul>
<p>And here is what <code class="docutils literal notranslate"><span class="pre">/etc/lighttpd/lighttpd.conf</span></code> looks like, once it is linked
with PHP-FPM:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">server</span><span class="o">.</span><span class="n">modules</span> <span class="o">+=</span> <span class="p">(</span> <span class="s2">&quot;mod_fastcgi&quot;</span> <span class="p">)</span>
<span class="n">index</span><span class="o">-</span><span class="n">file</span><span class="o">.</span><span class="n">names</span> <span class="o">+=</span> <span class="p">(</span> <span class="s2">&quot;index.php&quot;</span> <span class="p">)</span>
<span class="n">fastcgi</span><span class="o">.</span><span class="n">server</span> <span class="o">+=</span> <span class="p">(</span>
    <span class="s2">&quot;.php&quot;</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="s2">&quot;localhost&quot;</span> <span class="o">=&gt;</span> <span class="p">(</span>
        <span class="s2">&quot;socket&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;/var/run/php5-fpm.sock&quot;</span><span class="p">,</span>
        <span class="s2">&quot;broken-scriptfilename&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;enable&quot;</span>
    <span class="p">))</span>
<span class="p">)</span>
<span class="n">alias</span><span class="o">.</span><span class="n">url</span> <span class="o">+=</span> <span class="p">(</span> <span class="s2">&quot;/my-php-pages&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;/srv/http/my-php-pages&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">PHP Configuration Customization</a><ul>
<li><a class="reference internal" href="#php-ini-configuration"><code class="docutils literal notranslate"><span class="pre">php.ini</span></code> configuration</a><ul>
<li><a class="reference internal" href="#common-important-configuration-options">Common important configuration options</a></li>
<li><a class="reference internal" href="#development-vs-production-options">Development vs. Production options</a></li>
<li><a class="reference internal" href="#php-size-limits">PHP size limits</a></li>
<li><a class="reference internal" href="#debian-default-configuration-file">Debian default configuration file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extensions-list">Extensions list</a></li>
<li><a class="reference internal" href="#apache-configuration">Apache configuration</a><ul>
<li><a class="reference internal" href="#rewrite-module">Rewrite module</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nginx-configuration">Nginx configuration</a><ul>
<li><a class="reference internal" href="#rewrite-directive">Rewrite directive</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lighttpd-configuration">Lighttpd configuration</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nginx.conf.raw.html"
                        title="previous chapter"><code class="docutils literal notranslate"><span class="pre">etc-server/web/nginx.conf</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ssl.html"
                        title="next chapter">SSL configuration on a web server</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/etc-server/web/php.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ssl.html" title="SSL configuration on a web server"
             >next</a> |</li>
        <li class="right" >
          <a href="nginx.conf.raw.html" title="etc-server/web/nginx.conf"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Generic Config</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><code class="docutils literal notranslate"><span class="pre">/etc</span></code> for Server</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013-2016, Nicolas Iooss.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.
    </div>
  </body>
</html>